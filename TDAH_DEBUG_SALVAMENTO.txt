================================================================================
DEBUG - TRIAGEM TDAH N√ÉO EST√Å SENDO SALVA
================================================================================

üîç NOVO TESTE COM LOGS DETALHADOS
================================================================================

Adicionei logs detalhados em:
- components/patient/TdahScreening.tsx
- hooks/useTdahScreening.ts

Agora voc√™ ver√° mensagens como:
‚úì üíæ Iniciando salvamento de triagem...
‚úì üìù Respostas: 100 perguntas respondidas
‚úì üìä Pontua√ß√£o total: 45 %
‚úì üîê Usu√°rio autenticado: [ID]
‚úì üìä N√≠vel de risco: Moderado
‚úì üì§ Enviando dados para Supabase: {...}
‚úì ‚úÖ Triagem salva com sucesso: {...}

================================================================================
PASSO 1: TESTAR SALVAMENTO
================================================================================

1. Abra o navegador e pressione F12 (Console)
2. Fa√ßa login como paciente
3. V√° para Dashboard > Triagem TDAH
4. Responda todas as 100 perguntas
5. Clique em "Ver Resultados"
6. Clique em "Salvar Resultados"
7. Procure no console por:

   ‚úì Se V√ä "‚úÖ Triagem salva com sucesso":
     ‚Üí Triagem foi salva! V√° para PASSO 2

   ‚úó Se V√ä "‚ùå Erro ao salvar triagem":
     ‚Üí H√° um erro. Copie a mensagem completa e v√° para PASSO 3

   ‚úó Se N√ÉO v√™ nenhuma mensagem:
     ‚Üí O bot√£o n√£o est√° funcionando. Verifique se h√° erros em vermelho

================================================================================
PASSO 2: VERIFICAR NO BANCO DE DADOS
================================================================================

Se a triagem foi salva com sucesso:

1. Abra Supabase Dashboard > SQL Editor
2. Execute:
   SELECT * FROM tdah_screenings ORDER BY created_at DESC LIMIT 1;

3. Voc√™ deve ver:
   ‚úì id: [UUID]
   ‚úì patient_id: [ID do paciente]
   ‚úì total_percentage: [n√∫mero]
   ‚úì risk_level: [Baixo/Moderado/Alto/Muito Alto]
   ‚úì created_at: [data/hora]

Se V√ä os dados:
   ‚Üí Triagem foi salva corretamente!
   ‚Üí V√° para PASSO 3 (verificar acesso do terapeuta)

Se N√ÉO v√™ os dados:
   ‚Üí H√° um problema na pol√≠tica RLS
   ‚Üí Execute: TDAH_SCREENING_FIX_RLS.sql

================================================================================
PASSO 3: VERIFICAR ACESSO DO TERAPEUTA
================================================================================

1. Abra Supabase Dashboard > SQL Editor
2. Copie o ID do paciente que fez a triagem
3. Execute:
   SELECT * FROM users WHERE id = 'COLE_O_ID_DO_PACIENTE';

4. Procure pela coluna "therapist_id":
   ‚úì Se est√° preenchida ‚Üí Paciente est√° associado a um terapeuta
   ‚úó Se √© NULL ‚Üí Paciente N√ÉO est√° associado

Se therapist_id √© NULL:
   ‚Üí Problema: Paciente n√£o foi cadastrado com terapeuta
   ‚Üí Solu√ß√£o: Cadastre o paciente novamente selecionando um terapeuta

Se therapist_id est√° preenchida:
   ‚Üí V√° para PASSO 4

================================================================================
PASSO 4: TESTAR ACESSO DO TERAPEUTA
================================================================================

1. Fa√ßa login como terapeuta
2. Abra o console (F12)
3. V√° para Dashboard > Triagens TDAH
4. Procure no console por:
   ‚úì "üîç Buscando triagens para paciente: [ID]"
   ‚úì "üìä Triagens encontradas: 1"

Se V√ä "Triagens encontradas: 1":
   ‚Üí Funcionou! A triagem deve aparecer na tela

Se V√ä "Triagens encontradas: 0":
   ‚Üí Problema na pol√≠tica RLS
   ‚Üí Execute: TDAH_SCREENING_FIX_RLS.sql
   ‚Üí Teste novamente

================================================================================
MENSAGENS DE ERRO COMUNS
================================================================================

‚ùå "Erro ao salvar triagem: Permission denied"
   ‚Üí Problema: Pol√≠tica RLS est√° bloqueando
   ‚Üí Solu√ß√£o: Execute TDAH_SCREENING_FIX_RLS.sql

‚ùå "Erro ao salvar triagem: relation \"tdah_screenings\" does not exist"
   ‚Üí Problema: Tabela n√£o foi criada
   ‚Üí Solu√ß√£o: Execute TDAH_SCREENING_SETUP.sql

‚ùå "Erro ao salvar triagem: Usu√°rio n√£o autenticado"
   ‚Üí Problema: Sess√£o expirou
   ‚Üí Solu√ß√£o: Fa√ßa login novamente

‚ùå "Erro ao salvar triagem: column \"answers\" is of type jsonb but expression is of type text"
   ‚Üí Problema: Tipo de dado incorreto
   ‚Üí Solu√ß√£o: Verifique se o JSON est√° sendo enviado corretamente

================================================================================
CHECKLIST ANTES DE REPORTAR
================================================================================

‚ñ° Respondeu todas as 100 perguntas?
‚ñ° Clicou em "Salvar Resultados"?
‚ñ° Viu a mensagem "Resultados salvos com sucesso!"?
‚ñ° Abriu o console (F12) e procurou pelos logs?
‚ñ° Executou o SQL de verifica√ß√£o?
‚ñ° Paciente tem therapist_id preenchido?
‚ñ° Executou TDAH_SCREENING_FIX_RLS.sql?
‚ñ° Limpou o cache (Ctrl+Shift+Delete)?
‚ñ° Reiniciou o navegador?

================================================================================
PR√ìXIMOS PASSOS
================================================================================

Se tudo funcionar:
1. Teste com v√°rios pacientes
2. Verifique se o terapeuta consegue ver todas as triagens
3. Teste expandir as categorias para ver respostas
4. Teste comparar triagens de diferentes datas

Se ainda n√£o funcionar:
1. Copie a mensagem de erro completa do console
2. Execute: TDAH_VERIFICAR_DADOS.sql
3. Compartilhe os resultados para debug

================================================================================
