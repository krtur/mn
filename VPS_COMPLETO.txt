============================================
ğŸ‰ VPS CONFIGURADO - FRONT + BACK AUTOMÃTICO
============================================

âœ… TUDO FUNCIONANDO!

ğŸŒ Frontend: http://31.97.252.100
ğŸ”Œ Backend API: http://31.97.252.100:3001/api
ğŸª Webhook: http://31.97.252.100:9000/hooks/mn-deploy

============================================
ğŸ“Š O QUE ESTÃ RODANDO
============================================

âœ… **Nginx** (porta 80)
   - Serve o frontend React (build em /var/www/mn/dist)
   - Configurado com cache e gzip

âœ… **Backend Node.js** (porta 3001)
   - Rodando com PM2 (auto-restart)
   - API endpoints: /api/login, /api/user, /api/logout
   - Conectado ao Supabase

âœ… **Webhook Listener** (porta 9000)
   - Detecta push no GitHub automaticamente
   - Executa deploy.sh a cada commit

âœ… **PM2 Process Manager**
   - Backend sempre rodando
   - Auto-restart em caso de erro
   - Inicia automaticamente no boot do servidor

============================================
ğŸ”„ DEPLOY AUTOMÃTICO
============================================

**Como funciona:**

1. VocÃª faz commit e push:
   git add .
   git commit -m "mensagem"
   git push origin main

2. GitHub envia webhook para VPS

3. VPS executa /var/www/mn/deploy.sh:
   âœ“ git pull origin main
   âœ“ npm install
   âœ“ npm run build (frontend)
   âœ“ pm2 restart mn-backend (backend)
   âœ“ systemctl restart nginx

4. Site atualizado em ~2-3 minutos!

============================================
âš™ï¸ CONFIGURAÃ‡Ã•ES IMPORTANTES
============================================

**API URL DinÃ¢mica:**
- Localhost: http://localhost:3001/api
- VPS: http://31.97.252.100:3001/api
- Detecta automaticamente via window.location.hostname

**Portas Abertas no Firewall:**
- 22 (SSH)
- 80 (HTTP - Frontend)
- 3001 (Backend API)
- 9000 (Webhook)

**Processos PM2:**
- mn-backend (server.js)
- Auto-restart habilitado
- Logs em /root/.pm2/logs/

============================================
ğŸ“Š COMANDOS ÃšTEIS
============================================

**Ver logs do backend:**
ssh root@31.97.252.100
pm2 logs mn-backend

**Ver logs do webhook:**
journalctl -u webhook -f

**Status dos serviÃ§os:**
pm2 status
systemctl status nginx
systemctl status webhook

**Deploy manual:**
/var/www/mn/deploy.sh

**Reiniciar backend:**
pm2 restart mn-backend

**Reiniciar tudo:**
pm2 restart all
systemctl restart nginx webhook

============================================
ğŸ§ª TESTAR AGORA
============================================

1. **Teste o frontend:**
   Abra: http://31.97.252.100
   
2. **Teste o backend:**
   curl http://31.97.252.100:3001/api/user
   (deve retornar erro 401 - Token nÃ£o fornecido)

3. **Teste o login:**
   - Acesse http://31.97.252.100
   - FaÃ§a login com:
     Email: marcelo@mnterapeutas.com
     Senha: Perante@1202
   - Deve funcionar!

4. **Teste deploy automÃ¡tico:**
   - FaÃ§a uma alteraÃ§Ã£o no cÃ³digo
   - git add . && git commit -m "teste" && git push
   - Aguarde 2-3 minutos
   - Recarregue o site

============================================
ğŸ” CREDENCIAIS
============================================

**VPS:**
- IP: 31.97.252.100
- UsuÃ¡rio: root
- Senha: Taliteus@1202

**GitHub Webhook:**
- URL: http://31.97.252.100:9000/hooks/mn-deploy
- Secret: c07e7eaa5d8bab70edf4b3acb837f9426ce96fbbd12ee2b270821cecb11b19b8

**Supabase:**
- URL: https://ygfxloachqjeslciyunr.supabase.co
- Key: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

**Terapeutas:**
- Marcelo: marcelo@mnterapeutas.com / Perante@1202
- Nadielma: nadi@mnterapeutas.com / Perante@1202

============================================
ğŸ“ ESTRUTURA NO VPS
============================================

/var/www/mn/
â”œâ”€â”€ dist/                 # Frontend build (servido pelo Nginx)
â”œâ”€â”€ src/                  # CÃ³digo fonte React
â”œâ”€â”€ services/             # APIs e Supabase
â”œâ”€â”€ server.js             # Backend Express
â”œâ”€â”€ deploy.sh             # Script de deploy automÃ¡tico
â”œâ”€â”€ package.json          # DependÃªncias
â””â”€â”€ .env                  # VariÃ¡veis de ambiente

/var/www/webhook/
â””â”€â”€ hooks.json            # ConfiguraÃ§Ã£o do webhook

/root/.pm2/
â”œâ”€â”€ logs/                 # Logs do PM2
â”‚   â”œâ”€â”€ mn-backend-out.log
â”‚   â””â”€â”€ mn-backend-error.log
â””â”€â”€ dump.pm2              # Estado dos processos

============================================
ğŸ”§ TROUBLESHOOTING
============================================

**Site nÃ£o carrega:**
systemctl restart nginx
systemctl status nginx

**API nÃ£o responde:**
pm2 restart mn-backend
pm2 logs mn-backend

**Webhook nÃ£o funciona:**
systemctl restart webhook
journalctl -u webhook -n 50

**Deploy nÃ£o atualiza:**
/var/www/mn/deploy.sh
# Veja os erros

**Backend crashou:**
pm2 restart mn-backend
pm2 logs mn-backend --lines 50

**Porta 3001 nÃ£o acessÃ­vel:**
ufw status
ufw allow 3001

============================================
ğŸ“ˆ PRÃ“XIMAS MELHORIAS
============================================

âœ… FEITO:
- Deploy automÃ¡tico (front + back)
- PM2 para gerenciar backend
- Webhook do GitHub
- Firewall configurado
- API URL dinÃ¢mica

ğŸ”œ FUTURO (OPCIONAL):
- [ ] Adicionar SSL/HTTPS (Let's Encrypt)
- [ ] Configurar domÃ­nio prÃ³prio
- [ ] Adicionar monitoramento (Uptime Robot)
- [ ] Configurar backups automÃ¡ticos
- [ ] Adicionar CI/CD com testes
- [ ] Configurar logs centralizados
- [ ] Adicionar cache Redis
- [ ] Configurar CDN (Cloudflare)

============================================
âœ… CHECKLIST FINAL
============================================

[âœ…] VPS configurado
[âœ…] Nginx rodando (porta 80)
[âœ…] Backend rodando (porta 3001)
[âœ…] PM2 gerenciando backend
[âœ…] Webhook configurado
[âœ…] Firewall configurado
[âœ…] Deploy automÃ¡tico funcionando
[âœ…] API URL dinÃ¢mica
[âœ…] Frontend acessÃ­vel
[âœ…] Backend acessÃ­vel
[â³] Webhook GitHub configurado (FAÃ‡A AGORA!)

============================================
ğŸ¯ CONFIGURAR WEBHOOK NO GITHUB
============================================

**ÃšLTIMO PASSO:**

1. Acesse: https://github.com/krtur/mn/settings/hooks

2. Clique em "Add webhook"

3. Preencha:
   - Payload URL: http://31.97.252.100:9000/hooks/mn-deploy
   - Content type: application/json
   - Secret: c07e7eaa5d8bab70edf4b3acb837f9426ce96fbbd12ee2b270821cecb11b19b8
   - SSL verification: Disable
   - Events: Just the push event
   - Active: âœ“

4. Salve e teste com um commit!

============================================
ğŸ‰ PRONTO!
============================================

Seu sistema estÃ¡ 100% funcional com:
âœ“ Frontend React no ar
âœ“ Backend Express rodando
âœ“ Deploy automÃ¡tico a cada push
âœ“ Tudo gerenciado pelo PM2 e Nginx

Agora Ã© sÃ³ desenvolver e fazer push!
O resto Ã© automÃ¡tico! ğŸš€
