============================================
VISUALIZAÃ‡ÃƒO - FUNCIONALIDADE DE MENSAGENS
============================================

============================================
FLUXO DE DADOS:
============================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PACIENTE (Patient)                       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Mensagens                                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  Nadielma (Terapeuta)                               â”‚  â”‚
â”‚  â”‚  nadi@mnterapeutas.com                              â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚ Terapeuta: OlÃ¡! Como vocÃª estÃ¡?              â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ 14:30                                          â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚                â”‚ Paciente: Tudo bem! E vocÃª?   â”‚  â”‚  â”‚
â”‚  â”‚                â”‚ 14:31                           â”‚  â”‚  â”‚
â”‚  â”‚                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚  [Digite sua mensagem...]          [ğŸ“¤ Enviar]     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•ï¸
                    (Supabase WebSocket)
                            â†•ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   TERAPEUTA (Therapist)                     â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Conversas (2)    â”‚  â”‚ Chat com Paciente               â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ ğŸ” Buscar...     â”‚  â”‚ JoÃ£o Silva                       â”‚â”‚
â”‚  â”‚                  â”‚  â”‚ joao@email.com                   â”‚â”‚
â”‚  â”‚ JoÃ£o Silva   [1] â”‚  â”‚                                  â”‚â”‚
â”‚  â”‚ joao@email.com   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚ "Tudo bem..."    â”‚  â”‚ â”‚ Paciente: Tudo bem! E vocÃª? â”‚â”‚â”‚
â”‚  â”‚                  â”‚  â”‚ â”‚ 14:31                        â”‚â”‚â”‚
â”‚  â”‚ Maria Santos [2] â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚ maria@email.com  â”‚  â”‚                                  â”‚â”‚
â”‚  â”‚ "Oi terapeuta"   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚
â”‚  â”‚                  â”‚  â”‚ â”‚ Terapeuta: Tudo bem sim!    â”‚â”‚â”‚
â”‚  â”‚ Pedro Costa      â”‚  â”‚ â”‚ 14:32                        â”‚â”‚â”‚
â”‚  â”‚ pedro@email.com  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚
â”‚  â”‚ "Sem mensagens"  â”‚  â”‚                                  â”‚â”‚
â”‚  â”‚                  â”‚  â”‚ [Digite sua mensagem...]  [ğŸ“¤]  â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

============================================
ARQUITETURA:
============================================

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRONTEND (React)                       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ App.tsx (Rotas)                                      â”‚  â”‚
â”‚  â”‚ - /dashboard/patient/messages                        â”‚  â”‚
â”‚  â”‚ - /dashboard/therapist/messages                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Componentes                                          â”‚  â”‚
â”‚  â”‚ - PatientMessages.tsx (Paciente)                    â”‚  â”‚
â”‚  â”‚ - TherapistMessages.tsx (Terapeuta)                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Hooks                                                â”‚  â”‚
â”‚  â”‚ - useMessages() (Busca e gerencia mensagens)        â”‚  â”‚
â”‚  â”‚ - useAuth() (AutenticaÃ§Ã£o)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Services                                             â”‚  â”‚
â”‚  â”‚ - supabase.ts (Cliente Supabase)                    â”‚  â”‚
â”‚  â”‚ - supabase-api.ts (FunÃ§Ãµes de API)                  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†•ï¸
                    (HTTPS + WebSocket)
                            â†•ï¸
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND (Supabase)                       â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PostgreSQL Database                                  â”‚  â”‚
â”‚  â”‚                                                      â”‚  â”‚
â”‚  â”‚ Tabela: messages                                     â”‚  â”‚
â”‚  â”‚ â”œâ”€ id (UUID)                                         â”‚  â”‚
â”‚  â”‚ â”œâ”€ sender_id (UUID)                                  â”‚  â”‚
â”‚  â”‚ â”œâ”€ recipient_id (UUID)                               â”‚  â”‚
â”‚  â”‚ â”œâ”€ content (TEXT)                                    â”‚  â”‚
â”‚  â”‚ â”œâ”€ read (BOOLEAN)                                    â”‚  â”‚
â”‚  â”‚ â”œâ”€ created_at (TIMESTAMP)                            â”‚  â”‚
â”‚  â”‚ â””â”€ updated_at (TIMESTAMP)                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Ãndices (Performance)                                â”‚  â”‚
â”‚  â”‚ â”œâ”€ idx_messages_sender_id                            â”‚  â”‚
â”‚  â”‚ â”œâ”€ idx_messages_recipient_id                         â”‚  â”‚
â”‚  â”‚ â”œâ”€ idx_messages_created_at                           â”‚  â”‚
â”‚  â”‚ â””â”€ idx_messages_conversation                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Row Level Security (RLS)                             â”‚  â”‚
â”‚  â”‚ â”œâ”€ messages_select (VÃª suas mensagens)              â”‚  â”‚
â”‚  â”‚ â”œâ”€ messages_insert (Envia mensagens)                â”‚  â”‚
â”‚  â”‚ â””â”€ messages_update (Marca como lida)                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                            â†“                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Realtime (WebSocket)                                 â”‚  â”‚
â”‚  â”‚ - Notifica mudanÃ§as em tempo real                    â”‚  â”‚
â”‚  â”‚ - Atualiza componentes automaticamente               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

============================================
FLUXO DE ENVIO DE MENSAGEM:
============================================

UsuÃ¡rio digita "OlÃ¡!"
        â†“
Clica em "Enviar"
        â†“
ValidaÃ§Ã£o (nÃ£o vazio)
        â†“
INSERT na tabela messages
        â†“
Supabase retorna ID
        â†“
Hook useMessages recebe notificaÃ§Ã£o
        â†“
Refetch de mensagens
        â†“
Componente re-renderiza
        â†“
Nova mensagem aparece Ã  direita
        â†“
Auto-scroll para a mensagem
        â†“
Input Ã© limpo
        â†“
âœ… Pronto!

============================================
FLUXO DE RECEBIMENTO DE MENSAGEM:
============================================

Outro usuÃ¡rio envia mensagem
        â†“
INSERT na tabela messages
        â†“
Supabase WebSocket notifica
        â†“
Hook useMessages recebe notificaÃ§Ã£o
        â†“
Refetch de mensagens
        â†“
Componente re-renderiza
        â†“
Nova mensagem aparece Ã  esquerda
        â†“
Auto-scroll para a mensagem
        â†“
Se conversa aberta: marca como lida
        â†“
UPDATE na tabela messages (read = true)
        â†“
âœ… Pronto!

============================================
ESTRUTURA DE PASTAS:
============================================

projeto/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ patient/
â”‚   â”‚   â””â”€â”€ Messages.tsx âœ…
â”‚   â”œâ”€â”€ therapist/
â”‚   â”‚   â””â”€â”€ Messages.tsx âœ…
â”‚   â””â”€â”€ auth/
â”‚       â””â”€â”€ AuthContext.tsx
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ useMessages.ts âœ…
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ supabase.ts
â”‚   â””â”€â”€ supabase-api.ts
â”œâ”€â”€ MESSAGES_SETUP.sql âœ…
â”œâ”€â”€ MENSAGENS_IMPLEMENTACAO.txt âœ…
â”œâ”€â”€ MENSAGENS_TESTE_RAPIDO.txt âœ…
â”œâ”€â”€ MENSAGENS_RESUMO.txt âœ…
â”œâ”€â”€ MENSAGENS_DEPLOYMENT.txt âœ…
â””â”€â”€ MENSAGENS_VISUAL.txt âœ…

============================================
TIPOS DE DADOS:
============================================

Message {
  id: string (UUID)
  sender_id: string (UUID)
  recipient_id: string (UUID)
  content: string
  read: boolean
  created_at: string (ISO 8601)
  sender?: {
    name: string
    email: string
    role?: string
  }
  recipient?: {
    name: string
    email: string
    role?: string
  }
}

Conversation {
  id: string (UUID do outro usuÃ¡rio)
  other_user_id: string (UUID)
  other_user_name: string
  other_user_email: string
  other_user_role?: string
  last_message: string
  last_message_time: string
  unread_count: number
}

============================================
FILTROS APLICADOS:
============================================

PACIENTE:
â”œâ”€ VÃª apenas conversas com role = 'therapist'
â”œâ”€ VÃª apenas 1 conversa (seu terapeuta)
â”œâ”€ VÃª mensagens que enviou ou recebeu
â””â”€ Marca como lida automaticamente

TERAPEUTA:
â”œâ”€ VÃª conversas com todos os pacientes
â”œâ”€ VÃª mÃºltiplas conversas
â”œâ”€ VÃª mensagens que enviou ou recebeu
â””â”€ Pode marcar como lida manualmente

============================================
PERMISSÃ•ES RLS:
============================================

SELECT:
â”œâ”€ auth.uid() = sender_id âœ“
â””â”€ auth.uid() = recipient_id âœ“

INSERT:
â””â”€ auth.uid() = sender_id âœ“

UPDATE:
â”œâ”€ auth.uid() = sender_id âœ“
â””â”€ auth.uid() = recipient_id âœ“

DELETE:
â””â”€ NÃ£o permitido (apenas admin)

============================================
PERFORMANCE:
============================================

Ãndices:
â”œâ”€ sender_id (busca rÃ¡pida por remetente)
â”œâ”€ recipient_id (busca rÃ¡pida por destinatÃ¡rio)
â”œâ”€ created_at (ordenaÃ§Ã£o rÃ¡pida)
â””â”€ conversation (busca rÃ¡pida de conversas)

WebSocket:
â”œâ”€ AtualizaÃ§Ã£o em tempo real
â”œâ”€ Sem polling
â””â”€ Baixa latÃªncia

Caching:
â”œâ”€ Estado local no React
â”œâ”€ Sem requisiÃ§Ãµes desnecessÃ¡rias
â””â”€ Re-render apenas quando necessÃ¡rio

============================================
SEGURANÃ‡A:
============================================

AutenticaÃ§Ã£o:
â”œâ”€ Supabase Auth (JWT)
â”œâ”€ SessÃ£o persistente
â””â”€ Logout limpa tokens

AutorizaÃ§Ã£o:
â”œâ”€ RLS no banco de dados
â”œâ”€ UsuÃ¡rios sÃ³ veem suas mensagens
â””â”€ ValidaÃ§Ã£o no backend

Criptografia:
â”œâ”€ HTTPS em trÃ¢nsito
â”œâ”€ Supabase criptografa em repouso
â””â”€ Sem dados sensÃ­veis em localStorage

============================================
PRÃ“XIMAS MELHORIAS:
============================================

Curto prazo:
â”œâ”€ PaginaÃ§Ã£o de mensagens antigas
â”œâ”€ Indicador de "digitando..."
â””â”€ ReaÃ§Ãµes a mensagens (emoji)

MÃ©dio prazo:
â”œâ”€ Anexos (imagens, documentos)
â”œâ”€ Busca em mensagens
â””â”€ NotificaÃ§Ãµes push

Longo prazo:
â”œâ”€ Ãudio/vÃ­deo chamada
â”œâ”€ Grupos de conversa
â””â”€ Criptografia end-to-end

============================================
FIM DA VISUALIZAÃ‡ÃƒO
============================================
