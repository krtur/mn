================================================================================
TRIAGEM TDAH PARA ADULTO - INTEGRAÃ‡ÃƒO COM BANCO DE DADOS
================================================================================

ðŸ“‹ RESUMO EXECUTIVO
================================================================================
A Triagem TDAH para Adulto foi integrada ao banco de dados Supabase com:
- Salvamento automÃ¡tico de respostas e resultados
- Acesso para terapeutas visualizarem triagens dos pacientes
- Interface completa para anÃ¡lise de resultados

================================================================================
ðŸŽ¯ FUNCIONALIDADES IMPLEMENTADAS
================================================================================

1. TABELA TDAH_SCREENINGS (Supabase)
   - Armazena todas as 100 respostas em JSON
   - PontuaÃ§Ãµes por categoria (A-F)
   - PontuaÃ§Ã£o total e percentual
   - NÃ­vel de risco (Baixo, Moderado, Alto, Muito Alto)
   - DuraÃ§Ã£o do teste em segundos
   - Timestamps de criaÃ§Ã£o e atualizaÃ§Ã£o

2. HOOK useTdahScreening
   - saveScreening(): Salva nova triagem
   - getPatientScreenings(): Busca triagens do paciente
   - getScreening(): Busca triagem especÃ­fica
   - getTherapistPatientScreenings(): Busca triagens de um paciente (para terapeutas)
   - updateScreening(): Atualiza triagem existente

3. COMPONENTE TdahScreening (Paciente)
   - BotÃ£o "Salvar Resultados" apÃ³s conclusÃ£o do teste
   - Feedback visual de sucesso/erro
   - Salvamento automÃ¡tico de todas as respostas

4. COMPONENTE TdahResults (Terapeuta)
   - Lista de pacientes com busca
   - HistÃ³rico de triagens por paciente
   - VisualizaÃ§Ã£o detalhada de cada triagem
   - AnÃ¡lise por categoria com respostas expandÃ­veis
   - InformaÃ§Ãµes de duraÃ§Ã£o e data

================================================================================
ðŸš€ COMO COMEÃ‡AR
================================================================================

PASSO 1: Executar SQL no Supabase
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Abra o Supabase Dashboard
2. VÃ¡ para SQL Editor
3. Copie todo o conteÃºdo do arquivo: TDAH_SCREENING_SETUP.sql
4. Cole e execute
5. Aguarde a conclusÃ£o

PASSO 2: Testar como Paciente
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. FaÃ§a login como paciente
2. VÃ¡ para Dashboard > Triagem TDAH
3. Clique em "Iniciar Teste"
4. Responda as 100 perguntas
5. Clique em "Ver Resultados"
6. Clique em "Salvar Resultados"
7. VocÃª verÃ¡ a mensagem "Resultados salvos com sucesso!"

PASSO 3: Testar como Terapeuta
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. FaÃ§a login como terapeuta
2. VÃ¡ para Dashboard > Triagens TDAH
3. Selecione um paciente na lista
4. Visualize as triagens realizadas
5. Clique em uma triagem para ver detalhes
6. Expanda as categorias para ver respostas individuais

================================================================================
ðŸ“Š ESTRUTURA DOS DADOS
================================================================================

Tabela: tdah_screenings

Colunas Principais:
â”œâ”€â”€ id (UUID) - Identificador Ãºnico
â”œâ”€â”€ patient_id (UUID) - ID do paciente
â”œâ”€â”€ therapist_id (UUID) - ID do terapeuta (opcional)
â”œâ”€â”€ answers (JSONB) - Todas as 100 respostas
â”‚   â””â”€â”€ Formato: {1: 2, 2: 3, 3: 1, ...}
â”œâ”€â”€ category_a_score (INTEGER) - PontuaÃ§Ã£o categoria A
â”œâ”€â”€ category_b_score (INTEGER) - PontuaÃ§Ã£o categoria B
â”œâ”€â”€ category_c_score (INTEGER) - PontuaÃ§Ã£o categoria C
â”œâ”€â”€ category_d_score (INTEGER) - PontuaÃ§Ã£o categoria D
â”œâ”€â”€ category_e_score (INTEGER) - PontuaÃ§Ã£o categoria E
â”œâ”€â”€ category_f_score (INTEGER) - PontuaÃ§Ã£o categoria F
â”œâ”€â”€ total_score (INTEGER) - Soma de todas as categorias
â”œâ”€â”€ total_percentage (INTEGER) - Percentual total (0-100)
â”œâ”€â”€ risk_level (VARCHAR) - 'Baixo', 'Moderado', 'Alto', 'Muito Alto'
â”œâ”€â”€ test_duration (INTEGER) - DuraÃ§Ã£o em segundos
â”œâ”€â”€ created_at (TIMESTAMP) - Data de criaÃ§Ã£o
â””â”€â”€ updated_at (TIMESTAMP) - Data de atualizaÃ§Ã£o

Ãndices Criados:
â”œâ”€â”€ idx_tdah_patient_id - Para buscar triagens por paciente
â”œâ”€â”€ idx_tdah_therapist_id - Para buscar triagens por terapeuta
â”œâ”€â”€ idx_tdah_created_at - Para ordenar por data
â””â”€â”€ idx_tdah_risk_level - Para filtrar por nÃ­vel de risco

================================================================================
ðŸ” SEGURANÃ‡A (Row Level Security)
================================================================================

PolÃ­ticas RLS Implementadas:

1. Pacientes podem ver suas prÃ³prias triagens
   - PolÃ­tica: "Patients can view own screenings"
   - CondiÃ§Ã£o: auth.uid() = patient_id

2. Pacientes podem inserir suas prÃ³prias triagens
   - PolÃ­tica: "Patients can insert own screenings"
   - CondiÃ§Ã£o: auth.uid() = patient_id

3. Pacientes podem atualizar suas prÃ³prias triagens
   - PolÃ­tica: "Patients can update own screenings"
   - CondiÃ§Ã£o: auth.uid() = patient_id

4. Terapeutas podem ver triagens de seus pacientes
   - PolÃ­tica: "Therapists can view patient screenings"
   - CondiÃ§Ã£o: therapist_id = auth.uid() OU paciente estÃ¡ associado ao terapeuta

================================================================================
ðŸ“ ARQUIVOS CRIADOS/MODIFICADOS
================================================================================

CRIADOS:
â”œâ”€â”€ TDAH_SCREENING_SETUP.sql - SQL para criar tabela e polÃ­ticas
â”œâ”€â”€ hooks/useTdahScreening.ts - Hook para gerenciar triagens
â””â”€â”€ components/therapist/TdahResults.tsx - Componente para terapeutas

MODIFICADOS:
â”œâ”€â”€ components/patient/TdahScreening.tsx - Adicionado botÃ£o de salvar
â”œâ”€â”€ App.tsx - Adicionada rota /dashboard/therapist/tdah-results
â”œâ”€â”€ components/dashboard/Sidebar.tsx - Adicionado link no menu
â””â”€â”€ hooks/index.ts - Exportado novo hook

================================================================================
ðŸ§ª TESTES RECOMENDADOS
================================================================================

TESTE 1: Salvar Triagem
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Login como paciente
2. Ir para Triagem TDAH
3. Responder todas as 100 perguntas
4. Clicar em "Salvar Resultados"
5. âœ“ Deve aparecer mensagem de sucesso
6. âœ“ Dados devem estar no banco

TESTE 2: Visualizar como Terapeuta
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Login como terapeuta
2. Ir para Dashboard > Triagens TDAH
3. Selecionar paciente que fez triagem
4. âœ“ Deve listar as triagens
5. âœ“ Deve mostrar pontuaÃ§Ã£o total
6. âœ“ Deve mostrar nÃ­vel de risco

TESTE 3: Expandir Categorias
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Na tela de triagens do terapeuta
2. Clicar em uma categoria para expandir
3. âœ“ Deve mostrar todas as perguntas e respostas
4. âœ“ Deve mostrar a resposta selecionada

TESTE 4: HistÃ³rico de Triagens
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
1. Paciente faz triagem 1
2. Paciente faz triagem 2
3. Terapeuta visualiza paciente
4. âœ“ Deve listar ambas as triagens
5. âœ“ Deve permitir comparar resultados

================================================================================
ðŸ”§ TROUBLESHOOTING
================================================================================

PROBLEMA: "Erro ao salvar triagem"
SOLUÃ‡ÃƒO:
- Verifique se o SQL foi executado corretamente
- Verifique se o RLS estÃ¡ habilitado
- Verifique as polÃ­ticas RLS na tabela
- Verifique se o usuÃ¡rio estÃ¡ autenticado

PROBLEMA: Terapeuta nÃ£o vÃª triagens do paciente
SOLUÃ‡ÃƒO:
- Verifique se a polÃ­tica RLS estÃ¡ correta
- Verifique se o therapist_id estÃ¡ configurado
- Verifique se o paciente estÃ¡ associado ao terapeuta

PROBLEMA: BotÃ£o "Salvar Resultados" nÃ£o aparece
SOLUÃ‡ÃƒO:
- Verifique se o componente TdahScreening foi atualizado
- Verifique se o hook useTdahScreening foi importado
- Verifique o console do navegador para erros

================================================================================
ðŸ“ˆ PRÃ“XIMOS PASSOS
================================================================================

1. Adicionar notas do terapeuta nas triagens
2. Permitir comparaÃ§Ã£o entre triagens
3. Gerar relatÃ³rios em PDF
4. Adicionar grÃ¡ficos de evoluÃ§Ã£o
5. Integrar com agendamentos (triagem antes de sessÃ£o)
6. Enviar notificaÃ§Ã£o quando paciente completa triagem
7. Adicionar anÃ¡lise de tendÃªncias

================================================================================
ðŸ“ž SUPORTE
================================================================================

Se encontrar problemas:
1. Verifique o console do navegador (F12)
2. Verifique os logs do Supabase
3. Verifique se o SQL foi executado corretamente
4. Verifique as polÃ­ticas RLS
5. Teste com dados fictÃ­cios primeiro

================================================================================
